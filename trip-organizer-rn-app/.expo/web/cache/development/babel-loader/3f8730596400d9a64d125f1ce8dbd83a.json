{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/szymongruszczynski/Documents/INZYNIERKA/repo_dir/trip-organizer/trip-organizer-rn-app/screens/features/trip_timeline/tripTimelineScreen.js\";\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Timeline from \"react-native-timeline-flatlist\";\nimport HorizontalDatePicker from \"@logisticinfotech/react-native-horizontal-date-picker\";\nimport { HeaderButtons, Item } from \"react-navigation-header-buttons\";\nimport HeaderButton from \"../../../components/technical/HeaderButton\";\nimport * as eventActions from \"../../../store/actions/events\";\n\nvar tripTimelineScreen = function tripTimelineScreen(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isRefreshing = _useState4[0],\n      setIsRefreshing = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isEditMode = _useState6[0],\n      setEditMode = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      error = _useState8[0],\n      setError = _useState8[1];\n\n  var events = useSelector(function (state) {\n    return state.events.tripEvents;\n  });\n  var dayEvents = events.filter(function (elem) {\n    elem.date == date;\n  });\n  var dispatch = useDispatch();\n  var trip = props.navigation.getParam(\"trip\");\n\n  var _useState9 = useState(new Date(trip.tripBeginning)),\n      _useState10 = _slicedToArray(_useState9, 2),\n      date = _useState10[0],\n      setDate = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      data = _useState12[0],\n      setData = _useState12[1];\n\n  useEffect(function () {\n    props.navigation.setParams({\n      trip: trip\n    });\n  }, [trip]);\n  useEffect(function () {\n    setData(events.filter(function (elem) {\n      return elem.date == date;\n    }).sort(compareEvents));\n  }, [date, events]);\n\n  onDateSelected = function onDateSelected(date) {\n    console.log(\"Selected Date:==>\", date);\n    setDate(date);\n  };\n\n  function compareEvents(a, b) {\n    if (new Date().setHours(a.time.substr(0, 2), a.time.substr(3), 0, 0) < new Date().setHours(b.time.substr(0, 2), b.time.substr(3), 0, 0)) {\n      return -1;\n    }\n\n    if (new Date().setHours(a.time.substr(0, 2), a.time.substr(3), 0, 0) > new Date().setHours(b.time.substr(0, 2), b.time.substr(3), 0, 0)) {\n      return 1;\n    }\n\n    return 0;\n  }\n\n  var loadEvents = useCallback(function _callee() {\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setError(null);\n            setIsRefreshing(true);\n            _context.prev = 2;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(dispatch(eventActions.getEvents(trip.id)));\n\n          case 5:\n            _context.next = 10;\n            break;\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](2);\n            setError(_context.t0.message);\n\n          case 10:\n            setIsRefreshing(false);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[2, 7]], Promise);\n  }, [dispatch, setIsLoading, setError]);\n  useEffect(function () {\n    var willFocusSub = props.navigation.addListener(\"willFocus\", loadEvents);\n    return function () {\n      willFocusSub.remove();\n    };\n  }, [loadEvents]);\n  useEffect(function () {\n    setIsLoading(true);\n    loadEvents().then(function () {\n      setIsLoading(false);\n    });\n  }, [dispatch, loadEvents]);\n\n  var pressHandler = function pressHandler(event) {\n    Alert.alert(event.title, \"What do you want to do with?\", [{\n      text: \"Delete\",\n      style: \"destructive\",\n      onPress: function onPress() {\n        console.log(\"Deleting\");\n        dispatch(eventActions.deleteEvent(event.id, trip.id));\n      }\n    }, {\n      text: \"Edit\",\n      style: \"default\",\n      onPress: function onPress() {\n        props.navigation.navigate(\"EventTime\", {\n          event: event,\n          trip: trip\n        });\n      }\n    }, {\n      text: \"Cancel\",\n      style: \"cancel\",\n      onPress: function onPress() {\n        console.log(\"Canceling\");\n      }\n    }]);\n  };\n\n  if (error) {\n    return React.createElement(View, {\n      style: styles.centered,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 7\n      }\n    }, React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    }, \"An error occurred!\"), React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }\n    }, error), React.createElement(Button, {\n      title: \"Try again\",\n      onPress: loadEvents,\n      color: \"red\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.datePickerContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }\n  }, React.createElement(HorizontalDatePicker, {\n    minDate: new Date(trip.tripBeginning),\n    maxDate: new Date(trip.tripEnding),\n    style: styles.datePicker,\n    pickerType: \"date\",\n    onDateSelected: onDateSelected,\n    isShowYear: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  })), isLoading ? React.createElement(View, {\n    style: {\n      flex: 1,\n      alignItems: \"center\",\n      justifyContent: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, React.createElement(ActivityIndicator, {\n    size: \"large\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  })) : React.createElement(Timeline, {\n    style: styles.list,\n    data: data,\n    separator: true,\n    circleSize: 20,\n    onEventPress: function onEventPress(event) {\n      pressHandler(event);\n    },\n    circleColor: \"orange\",\n    lineColor: \"grey\",\n    timeContainerStyle: {\n      minWidth: 52,\n      marginTop: -5\n    },\n    timeStyle: {\n      textAlign: \"center\",\n      backgroundColor: \"#147efb\",\n      color: \"white\",\n      padding: 5,\n      borderRadius: 13,\n      overflow: \"hidden\"\n    },\n    titleStyle: {\n      color: \"white\"\n    },\n    descriptionStyle: {\n      color: \"gray\"\n    },\n    options: {\n      refreshControl: React.createElement(RefreshControl, {\n        refreshing: isRefreshing,\n        onRefresh: loadEvents,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 15\n        }\n      }),\n      style: {\n        paddingTop: 5\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }\n  }));\n};\n\ntripTimelineScreen.navigationOptions = function (navData) {\n  var trip = navData.navigation.getParam(\"trip\");\n  return {\n    headerTitle: \"Timeline\",\n    headerRight: function headerRight() {\n      return React.createElement(HeaderButtons, {\n        HeaderButtonComponent: HeaderButton,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 7\n        }\n      }, React.createElement(Item, {\n        buttonStyle: {\n          color: \"#147efb\"\n        },\n        title: \"Add\",\n        iconName: \"ios-add-circle-outline\",\n        onPress: function onPress() {\n          navData.navigation.navigate(\"EventTime\", {\n            trip: trip,\n            event: -1\n          });\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 9\n        }\n      }));\n    }\n  };\n};\n\nvar styles = StyleSheet.create({\n  datePickerContainer: {\n    paddingBottom: 10,\n    borderBottomColor: \"grey\",\n    borderBottomWidth: 2\n  },\n  container: {\n    flex: 1,\n    padding: 20,\n    backgroundColor: \"#2C2C2E\"\n  },\n  list: {\n    flex: 1,\n    paddingTop: 5\n  },\n  datePicker: {\n    width: \"100%\"\n  }\n});\nexport default tripTimelineScreen;","map":{"version":3,"sources":["/Users/szymongruszczynski/Documents/INZYNIERKA/repo_dir/trip-organizer/trip-organizer-rn-app/screens/features/trip_timeline/tripTimelineScreen.js"],"names":["React","useState","useEffect","useCallback","useDispatch","useSelector","Timeline","HorizontalDatePicker","HeaderButtons","Item","HeaderButton","eventActions","tripTimelineScreen","props","isLoading","setIsLoading","isRefreshing","setIsRefreshing","isEditMode","setEditMode","error","setError","events","state","tripEvents","dayEvents","filter","elem","date","dispatch","trip","navigation","getParam","Date","tripBeginning","setDate","data","setData","setParams","sort","compareEvents","onDateSelected","console","log","a","b","setHours","time","substr","loadEvents","getEvents","id","message","willFocusSub","addListener","remove","then","pressHandler","event","Alert","alert","title","text","style","onPress","deleteEvent","navigate","styles","centered","container","datePickerContainer","tripEnding","datePicker","flex","alignItems","justifyContent","list","minWidth","marginTop","textAlign","backgroundColor","color","padding","borderRadius","overflow","refreshControl","paddingTop","navigationOptions","navData","headerTitle","headerRight","StyleSheet","create","paddingBottom","borderBottomColor","borderBottomWidth","width"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,WAArC,QAAwD,OAAxD;;;;;;;;AAUA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAEA,OAAOC,QAAP,MAAqB,gCAArB;AACA,OAAOC,oBAAP,MAAiC,uDAAjC;AACA,SAASC,aAAT,EAAwBC,IAAxB,QAAoC,iCAApC;AACA,OAAOC,YAAP;AACA,OAAO,KAAKC,YAAZ;;AAEA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,KAAD,EAAW;AAAA,kBACFZ,QAAQ,CAAC,KAAD,CADN;AAAA;AAAA,MAC7Ba,SAD6B;AAAA,MAClBC,YADkB;;AAAA,mBAEId,QAAQ,CAAC,KAAD,CAFZ;AAAA;AAAA,MAE7Be,YAF6B;AAAA,MAEfC,eAFe;;AAAA,mBAGFhB,QAAQ,CAAC,KAAD,CAHN;AAAA;AAAA,MAG7BiB,UAH6B;AAAA,MAGjBC,WAHiB;;AAAA,mBAIVlB,QAAQ,EAJE;AAAA;AAAA,MAI7BmB,KAJ6B;AAAA,MAItBC,QAJsB;;AAKpC,MAAMC,MAAM,GAAGjB,WAAW,CAAC,UAACkB,KAAD;AAAA,WAAWA,KAAK,CAACD,MAAN,CAAaE,UAAxB;AAAA,GAAD,CAA1B;AACA,MAAIC,SAAS,GAAGH,MAAM,CAACI,MAAP,CAAc,UAACC,IAAD,EAAU;AACtCA,IAAAA,IAAI,CAACC,IAAL,IAAaA,IAAb;AACD,GAFe,CAAhB;AAGA,MAAMC,QAAQ,GAAGzB,WAAW,EAA5B;AAEA,MAAM0B,IAAI,GAAGjB,KAAK,CAACkB,UAAN,CAAiBC,QAAjB,CAA0B,MAA1B,CAAb;;AAXoC,mBAYZ/B,QAAQ,CAAC,IAAIgC,IAAJ,CAASH,IAAI,CAACI,aAAd,CAAD,CAZI;AAAA;AAAA,MAY7BN,IAZ6B;AAAA,MAYvBO,OAZuB;;AAAA,oBAaZlC,QAAQ,CAAC,EAAD,CAbI;AAAA;AAAA,MAa7BmC,IAb6B;AAAA,MAavBC,OAbuB;;AAepCnC,EAAAA,SAAS,CAAC,YAAM;AACdW,IAAAA,KAAK,CAACkB,UAAN,CAAiBO,SAAjB,CAA2B;AAAER,MAAAA,IAAI,EAAEA;AAAR,KAA3B;AACD,GAFQ,EAEN,CAACA,IAAD,CAFM,CAAT;AAIA5B,EAAAA,SAAS,CAAC,YAAM;AACdmC,IAAAA,OAAO,CAACf,MAAM,CAACI,MAAP,CAAc,UAACC,IAAD;AAAA,aAAUA,IAAI,CAACC,IAAL,IAAaA,IAAvB;AAAA,KAAd,EAA2CW,IAA3C,CAAgDC,aAAhD,CAAD,CAAP;AACD,GAFQ,EAEN,CAACZ,IAAD,EAAON,MAAP,CAFM,CAAT;;AAIAmB,EAAAA,cAAc,GAAG,wBAACb,IAAD,EAAU;AACzBc,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCf,IAAjC;AACAO,IAAAA,OAAO,CAACP,IAAD,CAAP;AACD,GAHD;;AAKA,WAASY,aAAT,CAAuBI,CAAvB,EAA0BC,CAA1B,EAA6B;AAC3B,QACE,IAAIZ,IAAJ,GAAWa,QAAX,CAAoBF,CAAC,CAACG,IAAF,CAAOC,MAAP,CAAc,CAAd,EAAiB,CAAjB,CAApB,EAAyCJ,CAAC,CAACG,IAAF,CAAOC,MAAP,CAAc,CAAd,CAAzC,EAA2D,CAA3D,EAA8D,CAA9D,IACA,IAAIf,IAAJ,GAAWa,QAAX,CAAoBD,CAAC,CAACE,IAAF,CAAOC,MAAP,CAAc,CAAd,EAAiB,CAAjB,CAApB,EAAyCH,CAAC,CAACE,IAAF,CAAOC,MAAP,CAAc,CAAd,CAAzC,EAA2D,CAA3D,EAA8D,CAA9D,CAFF,EAGE;AACA,aAAO,CAAC,CAAR;AACD;;AACD,QACE,IAAIf,IAAJ,GAAWa,QAAX,CAAoBF,CAAC,CAACG,IAAF,CAAOC,MAAP,CAAc,CAAd,EAAiB,CAAjB,CAApB,EAAyCJ,CAAC,CAACG,IAAF,CAAOC,MAAP,CAAc,CAAd,CAAzC,EAA2D,CAA3D,EAA8D,CAA9D,IACA,IAAIf,IAAJ,GAAWa,QAAX,CAAoBD,CAAC,CAACE,IAAF,CAAOC,MAAP,CAAc,CAAd,EAAiB,CAAjB,CAApB,EAAyCH,CAAC,CAACE,IAAF,CAAOC,MAAP,CAAc,CAAd,CAAzC,EAA2D,CAA3D,EAA8D,CAA9D,CAFF,EAGE;AACA,aAAO,CAAP;AACD;;AACD,WAAO,CAAP;AACD;;AAED,MAAMC,UAAU,GAAG9C,WAAW,CAAC;AAAA;AAAA;AAAA;AAAA;AAC7BkB,YAAAA,QAAQ,CAAC,IAAD,CAAR;AACAJ,YAAAA,eAAe,CAAC,IAAD,CAAf;AAF6B;AAAA;AAAA,6CAIrBY,QAAQ,CAAClB,YAAY,CAACuC,SAAb,CAAuBpB,IAAI,CAACqB,EAA5B,CAAD,CAJa;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAM3B9B,YAAAA,QAAQ,CAAC,YAAI+B,OAAL,CAAR;;AAN2B;AAQ7BnC,YAAAA,eAAe,CAAC,KAAD,CAAf;;AAR6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,EAS3B,CAACY,QAAD,EAAWd,YAAX,EAAyBM,QAAzB,CAT2B,CAA9B;AAWAnB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMmD,YAAY,GAAGxC,KAAK,CAACkB,UAAN,CAAiBuB,WAAjB,CAA6B,WAA7B,EAA0CL,UAA1C,CAArB;AAEA,WAAO,YAAM;AACXI,MAAAA,YAAY,CAACE,MAAb;AACD,KAFD;AAGD,GANQ,EAMN,CAACN,UAAD,CANM,CAAT;AAQA/C,EAAAA,SAAS,CAAC,YAAM;AACda,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACAkC,IAAAA,UAAU,GAAGO,IAAb,CAAkB,YAAM;AACtBzC,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,KAFD;AAGD,GALQ,EAKN,CAACc,QAAD,EAAWoB,UAAX,CALM,CAAT;;AAOA,MAAMQ,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC9BC,IAAAA,KAAK,CAACC,KAAN,CAAYF,KAAK,CAACG,KAAlB,EAAyB,8BAAzB,EAAyD,CACvD;AACEC,MAAAA,IAAI,EAAE,QADR;AAEEC,MAAAA,KAAK,EAAE,aAFT;AAGEC,MAAAA,OAAO,EAAE,mBAAM;AACbtB,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AAEAd,QAAAA,QAAQ,CAAClB,YAAY,CAACsD,WAAb,CAAyBP,KAAK,CAACP,EAA/B,EAAmCrB,IAAI,CAACqB,EAAxC,CAAD,CAAR;AACD;AAPH,KADuD,EAUvD;AACEW,MAAAA,IAAI,EAAE,MADR;AAEEC,MAAAA,KAAK,EAAE,SAFT;AAGEC,MAAAA,OAAO,EAAE,mBAAM;AACbnD,QAAAA,KAAK,CAACkB,UAAN,CAAiBmC,QAAjB,CAA0B,WAA1B,EAAuC;AACrCR,UAAAA,KAAK,EAAEA,KAD8B;AAErC5B,UAAAA,IAAI,EAAEA;AAF+B,SAAvC;AAID;AARH,KAVuD,EAoBvD;AACEgC,MAAAA,IAAI,EAAE,QADR;AAEEC,MAAAA,KAAK,EAAE,QAFT;AAGEC,MAAAA,OAAO,EAAE,mBAAM;AACbtB,QAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACD;AALH,KApBuD,CAAzD;AA4BD,GA7BD;;AA8BA,MAAIvB,KAAJ,EAAW;AACT,WACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE+C,MAAM,CAACC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF,EAEE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOhD,KAAP,CAFF,EAGE,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAC,WAAd;AAA0B,MAAA,OAAO,EAAE6B,UAAnC;AAA+C,MAAA,KAAK,EAAC,KAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHF,CADF;AAOD;;AAED,SACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEkB,MAAM,CAACE,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEF,MAAM,CAACG,mBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,oBAAD;AACE,IAAA,OAAO,EAAE,IAAIrC,IAAJ,CAASH,IAAI,CAACI,aAAd,CADX;AAEE,IAAA,OAAO,EAAE,IAAID,IAAJ,CAASH,IAAI,CAACyC,UAAd,CAFX;AAGE,IAAA,KAAK,EAAEJ,MAAM,CAACK,UAHhB;AAIE,IAAA,UAAU,EAAE,MAJd;AAKE,IAAA,cAAc,EAAE/B,cALlB;AAME,IAAA,UAAU,EAAE,IANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAFF,EAYG3B,SAAS,GACR,oBAAC,IAAD;AACE,IAAA,KAAK,EAAE;AAAE2D,MAAAA,IAAI,EAAE,CAAR;AAAWC,MAAAA,UAAU,EAAE,QAAvB;AAAiCC,MAAAA,cAAc,EAAE;AAAjD,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGE,oBAAC,iBAAD;AAAmB,IAAA,IAAI,EAAC,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,CADQ,GAOR,oBAAC,QAAD;AACE,IAAA,KAAK,EAAER,MAAM,CAACS,IADhB;AAEE,IAAA,IAAI,EAAExC,IAFR;AAGE,IAAA,SAAS,EAAE,IAHb;AAIE,IAAA,UAAU,EAAE,EAJd;AAKE,IAAA,YAAY,EAAE,sBAACsB,KAAD,EAAW;AACvBD,MAAAA,YAAY,CAACC,KAAD,CAAZ;AACD,KAPH;AAQE,IAAA,WAAW,EAAC,QARd;AASE,IAAA,SAAS,EAAC,MATZ;AAUE,IAAA,kBAAkB,EAAE;AAAEmB,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,SAAS,EAAE,CAAC;AAA5B,KAVtB;AAWE,IAAA,SAAS,EAAE;AACTC,MAAAA,SAAS,EAAE,QADF;AAETC,MAAAA,eAAe,EAAE,SAFR;AAGTC,MAAAA,KAAK,EAAE,OAHE;AAITC,MAAAA,OAAO,EAAE,CAJA;AAKTC,MAAAA,YAAY,EAAE,EALL;AAMTC,MAAAA,QAAQ,EAAE;AAND,KAXb;AAmBE,IAAA,UAAU,EAAE;AAAEH,MAAAA,KAAK,EAAE;AAAT,KAnBd;AAoBE,IAAA,gBAAgB,EAAE;AAAEA,MAAAA,KAAK,EAAE;AAAT,KApBpB;AAqBE,IAAA,OAAO,EAAE;AACPI,MAAAA,cAAc,EACZ,oBAAC,cAAD;AACE,QAAA,UAAU,EAAErE,YADd;AAEE,QAAA,SAAS,EAAEiC,UAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFK;AAOPc,MAAAA,KAAK,EAAE;AAAEuB,QAAAA,UAAU,EAAE;AAAd;AAPA,KArBX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAnBJ,CADF;AAsDD,CApKD;;AAsKA1E,kBAAkB,CAAC2E,iBAAnB,GAAuC,UAACC,OAAD,EAAa;AAClD,MAAM1D,IAAI,GAAG0D,OAAO,CAACzD,UAAR,CAAmBC,QAAnB,CAA4B,MAA5B,CAAb;AAEA,SAAO;AACLyD,IAAAA,WAAW,EAAE,UADR;AAELC,IAAAA,WAAW,EAAE;AAAA,aACX,oBAAC,aAAD;AAAe,QAAA,qBAAqB,EAAEhF,YAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AACE,QAAA,WAAW,EAAE;AAAEuE,UAAAA,KAAK,EAAE;AAAT,SADf;AAEE,QAAA,KAAK,EAAC,KAFR;AAGE,QAAA,QAAQ,EAAC,wBAHX;AAIE,QAAA,OAAO,EAAE,mBAAM;AACbO,UAAAA,OAAO,CAACzD,UAAR,CAAmBmC,QAAnB,CAA4B,WAA5B,EAAyC;AAAEpC,YAAAA,IAAI,EAAEA,IAAR;AAAc4B,YAAAA,KAAK,EAAE,CAAC;AAAtB,WAAzC;AACD,SANH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADW;AAAA;AAFR,GAAP;AAeD,CAlBD;;AAoBA,IAAMS,MAAM,GAAGwB,UAAU,CAACC,MAAX,CAAkB;AAC/BtB,EAAAA,mBAAmB,EAAE;AACnBuB,IAAAA,aAAa,EAAE,EADI;AAEnBC,IAAAA,iBAAiB,EAAE,MAFA;AAGnBC,IAAAA,iBAAiB,EAAE;AAHA,GADU;AAM/B1B,EAAAA,SAAS,EAAE;AACTI,IAAAA,IAAI,EAAE,CADG;AAETS,IAAAA,OAAO,EAAE,EAFA;AAITF,IAAAA,eAAe,EAAE;AAJR,GANoB;AAY/BJ,EAAAA,IAAI,EAAE;AACJH,IAAAA,IAAI,EAAE,CADF;AAEJa,IAAAA,UAAU,EAAE;AAFR,GAZyB;AAiB/Bd,EAAAA,UAAU,EAAE;AACVwB,IAAAA,KAAK,EAAE;AADG;AAjBmB,CAAlB,CAAf;AAqBA,eAAepF,kBAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  Text,\n  View,\n  StyleSheet,\n  Button,\n  ActivityIndicator,\n  RefreshControl,\n  Alert,\n} from \"react-native\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport Timeline from \"react-native-timeline-flatlist\";\nimport HorizontalDatePicker from \"@logisticinfotech/react-native-horizontal-date-picker\";\nimport { HeaderButtons, Item } from \"react-navigation-header-buttons\";\nimport HeaderButton from \"../../../components/technical/HeaderButton\";\nimport * as eventActions from \"../../../store/actions/events\";\n\nconst tripTimelineScreen = (props) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [isEditMode, setEditMode] = useState(false);\n  const [error, setError] = useState();\n  const events = useSelector((state) => state.events.tripEvents);\n  let dayEvents = events.filter((elem) => {\n    elem.date == date;\n  });\n  const dispatch = useDispatch();\n\n  const trip = props.navigation.getParam(\"trip\");\n  const [date, setDate] = useState(new Date(trip.tripBeginning));\n  const [data, setData] = useState([]);\n\n  useEffect(() => {\n    props.navigation.setParams({ trip: trip });\n  }, [trip]);\n\n  useEffect(() => {\n    setData(events.filter((elem) => elem.date == date).sort(compareEvents));\n  }, [date, events]);\n\n  onDateSelected = (date) => {\n    console.log(\"Selected Date:==>\", date);\n    setDate(date);\n  };\n\n  function compareEvents(a, b) {\n    if (\n      new Date().setHours(a.time.substr(0, 2), a.time.substr(3), 0, 0) <\n      new Date().setHours(b.time.substr(0, 2), b.time.substr(3), 0, 0)\n    ) {\n      return -1;\n    }\n    if (\n      new Date().setHours(a.time.substr(0, 2), a.time.substr(3), 0, 0) >\n      new Date().setHours(b.time.substr(0, 2), b.time.substr(3), 0, 0)\n    ) {\n      return 1;\n    }\n    return 0;\n  }\n\n  const loadEvents = useCallback(async () => {\n    setError(null);\n    setIsRefreshing(true);\n    try {\n      await dispatch(eventActions.getEvents(trip.id));\n    } catch (err) {\n      setError(err.message);\n    }\n    setIsRefreshing(false);\n  }, [dispatch, setIsLoading, setError]);\n\n  useEffect(() => {\n    const willFocusSub = props.navigation.addListener(\"willFocus\", loadEvents);\n\n    return () => {\n      willFocusSub.remove();\n    };\n  }, [loadEvents]);\n\n  useEffect(() => {\n    setIsLoading(true);\n    loadEvents().then(() => {\n      setIsLoading(false);\n    });\n  }, [dispatch, loadEvents]);\n\n  const pressHandler = (event) => {\n    Alert.alert(event.title, \"What do you want to do with?\", [\n      {\n        text: \"Delete\",\n        style: \"destructive\",\n        onPress: () => {\n          console.log(\"Deleting\");\n\n          dispatch(eventActions.deleteEvent(event.id, trip.id));\n        },\n      },\n      {\n        text: \"Edit\",\n        style: \"default\",\n        onPress: () => {\n          props.navigation.navigate(\"EventTime\", {\n            event: event,\n            trip: trip,\n          });\n        },\n      },\n      {\n        text: \"Cancel\",\n        style: \"cancel\",\n        onPress: () => {\n          console.log(\"Canceling\");\n        },\n      },\n    ]);\n  };\n  if (error) {\n    return (\n      <View style={styles.centered}>\n        <Text>An error occurred!</Text>\n        <Text>{error}</Text>\n        <Button title=\"Try again\" onPress={loadEvents} color=\"red\" />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <Text></Text>\n      <View style={styles.datePickerContainer}>\n        <HorizontalDatePicker\n          minDate={new Date(trip.tripBeginning)}\n          maxDate={new Date(trip.tripEnding)}\n          style={styles.datePicker}\n          pickerType={\"date\"}\n          onDateSelected={onDateSelected}\n          isShowYear={true}\n        />\n      </View>\n      {isLoading ? (\n        <View\n          style={{ flex: 1, alignItems: \"center\", justifyContent: \"center\" }}\n        >\n          <ActivityIndicator size=\"large\" />\n        </View>\n      ) : (\n        <Timeline\n          style={styles.list}\n          data={data}\n          separator={true}\n          circleSize={20}\n          onEventPress={(event) => {\n            pressHandler(event);\n          }}\n          circleColor=\"orange\"\n          lineColor=\"grey\"\n          timeContainerStyle={{ minWidth: 52, marginTop: -5 }}\n          timeStyle={{\n            textAlign: \"center\",\n            backgroundColor: \"#147efb\",\n            color: \"white\",\n            padding: 5,\n            borderRadius: 13,\n            overflow: \"hidden\",\n          }}\n          titleStyle={{ color: \"white\" }}\n          descriptionStyle={{ color: \"gray\" }}\n          options={{\n            refreshControl: (\n              <RefreshControl\n                refreshing={isRefreshing}\n                onRefresh={loadEvents}\n              />\n            ),\n            style: { paddingTop: 5 },\n          }}\n        />\n      )}\n    </View>\n  );\n};\n\ntripTimelineScreen.navigationOptions = (navData) => {\n  const trip = navData.navigation.getParam(\"trip\");\n\n  return {\n    headerTitle: \"Timeline\",\n    headerRight: () => (\n      <HeaderButtons HeaderButtonComponent={HeaderButton}>\n        <Item\n          buttonStyle={{ color: \"#147efb\" }}\n          title=\"Add\"\n          iconName=\"ios-add-circle-outline\"\n          onPress={() => {\n            navData.navigation.navigate(\"EventTime\", { trip: trip, event: -1 });\n          }}\n        />\n      </HeaderButtons>\n    ),\n  };\n};\n\nconst styles = StyleSheet.create({\n  datePickerContainer: {\n    paddingBottom: 10,\n    borderBottomColor: \"grey\",\n    borderBottomWidth: 2,\n  },\n  container: {\n    flex: 1,\n    padding: 20,\n    //paddingTop: 65,\n    backgroundColor: \"#2C2C2E\",\n  },\n  list: {\n    flex: 1,\n    paddingTop: 5,\n    // marginTop: 3,\n  },\n  datePicker: {\n    width: \"100%\",\n  },\n});\nexport default tripTimelineScreen;\n"]},"metadata":{},"sourceType":"module"}